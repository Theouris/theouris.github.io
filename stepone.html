<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Theouris — Step 1</title>
  <style>
    :root{
      --bg: #081a2b;
      --panel: #0b2238;
      --panel-2: #0e2b46;
      --text: #eef5ff;
      --muted: rgba(238,245,255,.72);
      --accent: #6aa6ff;
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --radius: 14px;
      --sidebar-width: 320px;
      --anim: 220ms ease;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body{
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: var(--bg);
      color: var(--text);
      overflow-x: hidden;
    }

    .topbar{
      position: sticky;
      top: 0;
      z-index: 30;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 14px;
      padding: 16px 18px;
      background: rgba(8,26,43,.75);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(238,245,255,.08);
    }

    .menu-btn{
      width: 44px;
      height: 44px;
      border: 1px solid rgba(238,245,255,.14);
      background: rgba(11,34,56,.65);
      border-radius: 12px;
      display: grid;
      place-items: center;
      cursor: pointer;
      transition: transform var(--anim), background var(--anim), border-color var(--anim);
      flex: 0 0 auto;
    }
    .menu-btn:hover{
      transform: translateY(-1px);
      border-color: rgba(106,166,255,.55);
      background: rgba(14,43,70,.8);
    }
    .bars{ width: 20px; height: 14px; position: relative; }
    .bars span{ position: absolute; left: 0; width: 100%; height: 2px; background: var(--text); border-radius: 999px; transition: transform var(--anim), top var(--anim), opacity var(--anim); }
    .bars span:nth-child(1){ top: 0; }
    .bars span:nth-child(2){ top: 6px; }
    .bars span:nth-child(3){ top: 12px; }
    body.sidebar-open .bars span:nth-child(1){ top: 6px; transform: rotate(45deg); }
    body.sidebar-open .bars span:nth-child(2){ opacity: 0; }
    body.sidebar-open .bars span:nth-child(3){ top: 6px; transform: rotate(-45deg); }

    .brand{
      display: inline-flex;
      align-items: center;
      gap: 10px;
      font-weight: 750;
      letter-spacing: .2px;
      padding: 8px 12px;
      border-radius: 10px;
      background: rgba(11,34,56,.65);
      border: 1px solid rgba(238,245,255,.06);
      cursor: pointer;
      text-decoration: none;
      color: inherit;
      transition: transform var(--anim), border-color var(--anim), background var(--anim);
    }
    .brand:hover{ transform: translateY(-2px); border-color: rgba(106,166,255,.45); }
    .brand:focus-visible{ outline: 3px solid rgba(106,166,255,.18); outline-offset: 3px; }
    .brand .dot{ width: 10px; height: 10px; border-radius: 999px; background: var(--accent); box-shadow: 0 0 18px rgba(106,166,255,.35); flex: 0 0 auto; }
    .brand div{ color: var(--muted); font-weight: 500; letter-spacing: .15px; }

    .overlay{ position: fixed; inset: 0; background: rgba(0,0,0,.45); opacity: 0; pointer-events: none; transition: opacity var(--anim); z-index: 20; }
    body.sidebar-open .overlay{ opacity: 1; pointer-events: auto; }

    .sidebar{ position: fixed; top: 0; left: 0; height: 100%; width: var(--sidebar-width); background: linear-gradient(180deg, rgba(11,34,56,.98), rgba(8,26,43,.98)); border-right: 1px solid rgba(238,245,255,.10); box-shadow: var(--shadow); transform: translateX(-105%); transition: transform var(--anim); z-index: 25; padding: 18px 14px; display: flex; flex-direction: column; gap: 14px; }
    body.sidebar-open .sidebar{ transform: translateX(0); }

    .sidebar-header{ display: flex; align-items: center; justify-content: space-between; gap: 10px; padding: 6px 6px 10px 6px; }
    .sidebar-title{ font-weight: 750; letter-spacing: .2px; }
    .sidebar-subtitle{ color: var(--muted); font-size: 13px; margin-top: 2px; }

    .nav{ margin-top: 6px; display: flex; flex-direction: column; gap: 8px; }
    .nav-item{ border: 1px solid rgba(238,245,255,.10); background: rgba(11,34,56,.55); border-radius: var(--radius); overflow: hidden; transition: border-color var(--anim), background var(--anim); }
    .nav-item.open{ border-color: rgba(106,166,255,.55); background: rgba(14,43,70,.65); }
    .nav-main{ width: 100%; padding: 14px 14px; display: flex; align-items: center; justify-content: space-between; cursor: pointer; user-select: none; font-weight: 650; background: transparent; color: var(--text); border: 0; text-align: left; font-size: 16px; }
    .chev{ width: 10px; height: 10px; border-right: 2px solid rgba(238,245,255,.85); border-bottom: 2px solid rgba(238,245,255,.85); transform: rotate(-45deg); transition: transform var(--anim); opacity: .9; margin-right: 4px; }
    .nav-item.open .chev{ transform: rotate(45deg); }
    .submenu{ max-height: 0; opacity: 0; transition: max-height var(--anim), opacity var(--anim); background: rgba(8,26,43,.35); border-top: 1px solid rgba(238,245,255,.08); }
    .nav-item.open .submenu{ max-height: 220px; opacity: 1; }
    .submenu a{ display: block; padding: 12px 14px; color: var(--muted); text-decoration: none; border-top: 1px solid rgba(238,245,255,.06); transition: background var(--anim), color var(--anim); font-size: 14px; }
    .submenu a:first-child{ border-top: none; }
    .submenu a:hover{ background: rgba(106,166,255,.12); color: var(--text); }

    /* Simple article area */
    main.post-area{ padding: 0 0 80px; }
    article.post{ max-width: none; width: 100%; margin: 0; padding: 12px 18px 0; box-sizing: border-box; color: var(--muted); line-height: 1.8; font-size: 16px; }
    article.post h2{ color: var(--text); margin-top: 0; }
    article.post img{ display: block; margin: 12px auto; max-width: 100%; height: auto; border-radius: 8px; }
    /* center text when a post requests it */
    article.post.center, article.post.center h2, article.post.center p { text-align: center; }
    /* allow centering of partial sections inside a post */
    article.post .center { text-align: center; }
    article.post .center p { text-align: center; }

    .footer{ margin-top: 22px; color: rgba(238,245,255,.55); font-size: 12.5px; }
    .kbd{ padding: 2px 7px; border-radius: 8px; border: 1px solid rgba(238,245,255,.12); background: rgba(0,0,0,.18); color: rgba(238,245,255,.85); font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; font-size: 12px; }
  </style>
</head>
<body>
  <!-- Menu partial will be loaded dynamically -->

  <header class="topbar">
    <button class="menu-btn" id="menuBtn" aria-label="Open menu" aria-expanded="false">
      <div class="bars" aria-hidden="true"><span></span><span></span><span></span></div>
    </button>

    <a class="brand" href="index.html" style="text-decoration:none; color:inherit;">
      <div class="dot"></div>
      <div>
        Theouris - Step 1
      </div>
    </a>
  </header>

  <!-- Main: single post area (plain text) -->
  <main class="post-area">
    <article id="post" class="post">
      <h2>Select a post</h2>
      <p>Choose an option from the Step 1 submenu to view that post. The content will replace this text.</p>
    </article>
  </main>

  <script>
    (async function(){
      try{
        const r = await fetch('menu.html');
        if(r.ok){
          const html = await r.text();
          document.body.insertAdjacentHTML('afterbegin', html);
          const s = document.createElement('script');
          s.src = 'menu.js';
          document.body.appendChild(s);
        }
      }catch(e){ console.error('Failed to load menu partial', e); }
    })();

    // Simple post store — replace or extend with your posts
    const POSTS = {
        card: {
          title: 'Step 1 — Cardio',
          body: `Will update in June 2026`,
          body: `This is the Cardiovascular post.\n\nWill update in June 2026.`
        },
      resp: {
        center: false, // this post wants centered text
        title: 'Step 1 — Respiratory',
        image: 'https://www.stritch.luc.edu/lumen/meded/radio/curriculum/medicine/396a1.jpg',
        body: `This is the Respiratory post.\n\nAdd long walls of text here for another post. You can paste multiple paragraphs.`
      },
      renal: {
        title: 'Step 1 — Renal',
        body: `This is the Renal post.\n\nMore content goes here.`
      },
      GI: {
        title: 'Step 1 — GI',
        body: `GI helper examples:\n\nExamples (rendered):\n[s=24]Large text using shorthand [s=24]...[/s][/s]\n\n[center][s=20]Centered and larger text[/s][/center]\n\nExamples (code shown):\nUse \u005B s=24 \u005D...\u005B\/s\u005D or \u005B size=1.2rem \u005D...\u005B\/size\u005D\n\nUse \u005B center \u005D...\u005B\/center\u005D to center parts of a post.\n\nReplace with your own sizes and content.`
      }
    };

    function renderPost(key){
      const el = document.getElementById('post');
      if(!key || !POSTS[key]){
        el.innerHTML = `<h2>Select a post</h2><p>Choose an option from the Step 1 submenu to view that post.</p>`;
        document.title = 'Theouris — Step 1';
        return;
      }
      const post = POSTS[key];
      // apply optional centering class
      el.className = post.center ? 'post center' : 'post';
      // convert newlines to paragraphs, with support for [center]...[/center], [size=...]...[/size]
      // and shorthand [s=...]...[/s]
      // normalize shorthand [s=...] to [size=...], append 'px' when only a number is provided
      const normalizedSizes = post.body.replace(/\[s=([^\]]+)\]([\s\S]*?)\[\/s\]/g, (m, size, inner) => {
        const unitSize = (/^\d+(?:\.\d+)?$/.test(size)) ? size + 'px' : size;
        return `[size=${unitSize}]${inner}[/size]`;
      });
      // convert [size=...] blocks to markers so paragraphs inside can be handled
      const bodyWithSizeMarkers = normalizedSizes.replace(/\[size=([^\]]+)\]([\s\S]*?)\[\/size\]/g, (m, size, inner) => `@@SIZE_START:${size}@@${inner}@@SIZE_END@@`);

      const mkParagraphs = (txt) => {
        // split paragraphs and convert newlines to <br>
        let html = txt.split('\n\n').map(p=>`<p>${p.replace(/\n/g,'<br>')}</p>`).join('');
        // replace size markers with wrapper divs (they may surround one or more paragraphs)
        html = html.replace(/@@SIZE_START:([^@]+)@@([\s\S]*?)@@SIZE_END@@/g, (m, size, innerHtml) => {
          return `<div style="font-size:${size}">${innerHtml}</div>`;
        });
        return html;
      };

      const re = /\[center\]([\s\S]*?)\[\/center\]/g;
      let htmlBody = '';
      let last = 0;
      let m;
      while ((m = re.exec(bodyWithSizeMarkers)) !== null) {
        htmlBody += mkParagraphs(bodyWithSizeMarkers.slice(last, m.index));
        htmlBody += `<div class="center">${mkParagraphs(m[1])}</div>`;
        last = re.lastIndex;
      }
      htmlBody += mkParagraphs(bodyWithSizeMarkers.slice(last));
      const imageHTML = post.image ? `<img src="${post.image}" alt="${post.title}">` : '';
      el.innerHTML = `<h2>${post.title}</h2>${imageHTML}${htmlBody}`;
      document.title = post.title + ' — Theouris';
      // scroll into view
      el.scrollIntoView({behavior:'smooth'});
    }

    function handleHash(){ renderPost(location.hash.replace('#','')); }
    window.addEventListener('hashchange', handleHash);
    // initial render
    handleHash();
  </script>
</body>
</html>
